import{s as p,t as k,w as O,r as a,j as e,m as i,I as y,o as Y,B as q,q as l}from"./index-0gfsL0uy.js";import{C as R,c as L}from"./card-DFvCEgtH.js";import{S as v,a as j,b as w,c as N,d}from"./select-VgW6waeO.js";import"./index-C5PDtfbs.js";import"./chevron-down-C2_7QqD8.js";async function W(r){const{data:x,error:n}=await p.rpc("create_org_and_owner",{p_name:r.name,p_description:r.description??null,p_website:r.website??null,p_industry_id:r.industry_id??null,p_company_size:r.company_size??null});if(n)throw n;const{data:u,error:o}=await p.from("orgs").select("id, name, slug").eq("id",x).single();if(o)throw o;return{...u,status:"approved"}}const T=[{value:"1-10",label:"1-10 employees"},{value:"11-50",label:"11-50 employees"},{value:"51-200",label:"51-200 employees"},{value:"201-1000",label:"201-1000 employees"},{value:"1000+",label:"1000+ employees"}];function $(){const r=k(),{refetch:x}=O(),[n,u]=a.useState(""),[o,_]=a.useState(""),[c,S]=a.useState(""),[m,A]=a.useState(""),[b,F]=a.useState(""),[E,C]=a.useState([]),[h,g]=a.useState(!1),[z,I]=a.useState(!0);a.useEffect(()=>{(async()=>{try{const{data:s,error:f}=await p.from("industries").select("id, name").order("name");if(f)throw f;C(s||[])}catch(s){console.error("Error fetching industries:",s),l.error("Failed to load industries")}finally{I(!1)}})()},[]);const D=t=>{if(!t.trim())return!0;try{const s=new URL(t.startsWith("http")?t:`https://${t}`);return s.protocol==="http:"||s.protocol==="https:"}catch{return!1}},B=async t=>{if(t.preventDefault(),!!n.trim()){if(c&&!D(c)){l.error("Please enter a valid website URL");return}g(!0);try{(await W({name:n.trim(),description:o.trim()||null,website:c.trim()||null,industry_id:m||null,company_size:b||null})).status==="pending"?l.success("Organization created! Your request is pending approval. You'll be notified once approved."):l.success("Organization created successfully! You are now a business user."),await x(),r("/app/insights")}catch(s){l.error(s.message??"Failed to create organization")}finally{g(!1)}}};return e.jsx("div",{className:"min-h-screen",style:{background:"#EAE6E2",padding:"1.5rem"},children:e.jsx("div",{className:"mx-auto max-w-xl py-10",children:e.jsx(R,{className:"border-0",style:{background:"#EAE6E2",boxShadow:"8px 8px 20px rgba(166, 150, 130, 0.3), -8px -8px 20px rgba(255, 255, 255, 0.85)",borderRadius:"24px"},children:e.jsxs(L,{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-[#3A3530]",children:"Create Your Organization"}),e.jsx("p",{className:"text-sm text-[#6B635B] mt-2",children:"Set up your business so teammates can post Insights and collaborate. Your organization will be reviewed before activation."}),e.jsxs("form",{onSubmit:B,className:"space-y-6 mt-6",children:[e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"name",className:"block text-sm font-medium text-[#3A3530] mb-2",children:["Organization name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(y,{id:"name",value:n,onChange:t=>u(t.target.value),placeholder:"Acme Inc.",className:"text-[#3A3530] placeholder:text-[#6B635B]",style:{background:"#F5F1ED",boxShadow:"inset 2px 2px 5px rgba(166, 150, 130, 0.1), inset -2px -2px 5px rgba(255, 255, 255, 0.5)",border:"none"},required:!0})]}),e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"description",className:"block text-sm font-medium text-[#3A3530] mb-2",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Y,{id:"description",value:o,onChange:t=>_(t.target.value),placeholder:"Tell us about your organization...",className:"min-h-[100px] text-[#3A3530] placeholder:text-[#6B635B]",style:{background:"#F5F1ED",boxShadow:"inset 6px 6px 12px rgba(166, 150, 130, 0.2), inset -6px -6px 12px rgba(255, 255, 255, 0.5)",border:"none"},required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"website",className:"block text-sm font-medium text-[#3A3530] mb-2",children:"Website"}),e.jsx(y,{id:"website",type:"url",value:c,onChange:t=>S(t.target.value),placeholder:"https://example.com",className:"text-[#3A3530] placeholder:text-[#6B635B]",style:{background:"#F5F1ED",boxShadow:"inset 2px 2px 5px rgba(166, 150, 130, 0.1), inset -2px -2px 5px rgba(255, 255, 255, 0.5)",border:"none"}})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"industry",className:"block text-sm font-medium text-[#3A3530] mb-2",children:"Industry"}),e.jsxs(v,{value:m||void 0,onValueChange:t=>A(t==="__none__"?"":t),disabled:z,children:[e.jsx(j,{className:"text-[#3A3530]",style:{background:"#F5F1ED",boxShadow:"inset 2px 2px 5px rgba(166, 150, 130, 0.1), inset -2px -2px 5px rgba(255, 255, 255, 0.5)",border:"none"},children:e.jsx(w,{placeholder:"Select an industry"})}),e.jsxs(N,{className:"bg-white border-[#D4CEC5] text-[#3A3530]",children:[e.jsx(d,{value:"__none__",className:"text-[#3A3530] focus:bg-[#F5F1ED] focus:text-[#3A3530]",children:"None"}),E.map(t=>e.jsx(d,{value:t.id,className:"text-[#3A3530] focus:bg-[#F5F1ED] focus:text-[#3A3530]",children:t.name},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"company-size",className:"block text-sm font-medium text-[#3A3530] mb-2",children:"Company size"}),e.jsxs(v,{value:b||void 0,onValueChange:t=>F(t==="__none__"?"":t),children:[e.jsx(j,{className:"text-[#3A3530]",style:{background:"#F5F1ED",boxShadow:"inset 2px 2px 5px rgba(166, 150, 130, 0.1), inset -2px -2px 5px rgba(255, 255, 255, 0.5)",border:"none"},children:e.jsx(w,{placeholder:"Select company size"})}),e.jsxs(N,{className:"bg-white border-[#D4CEC5] text-[#3A3530]",children:[e.jsx(d,{value:"__none__",className:"text-[#3A3530] focus:bg-[#F5F1ED] focus:text-[#3A3530]",children:"None"}),T.map(t=>e.jsx(d,{value:t.value,className:"text-[#3A3530] focus:bg-[#F5F1ED] focus:text-[#3A3530]",children:t.label},t.value))]})]})]}),e.jsx(q,{type:"submit",disabled:h||!n.trim()||!o.trim(),className:"w-full text-white bg-[#3A3530] hover:bg-[#2A2520]",style:{boxShadow:"4px 4px 8px rgba(166, 150, 130, 0.2), -4px -4px 8px rgba(255, 255, 255, 0.6)"},children:h?"Creatingâ€¦":"Create organization"}),e.jsx("p",{className:"text-xs text-[#6B635B] text-center",children:"Your organization will be reviewed before activation. You'll receive a notification once approved."})]})]})})})})}export{$ as default};
