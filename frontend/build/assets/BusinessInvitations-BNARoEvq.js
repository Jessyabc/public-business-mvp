import{ap as A,w as F,r as h,j as e,au as M,B as i,I as R,A as n,z as D}from"./index-DdiXzYE2.js";import{C as u,a as j,b as v,d as b,c as g}from"./card-CVxPj8sa.js";import{S as U}from"./separator-D1CoJcnG.js";import{u as _}from"./useBusinessInvitations-CQdbsXVr.js";import{U as z}from"./user-plus-B-KuX2ip.js";import{C as T}from"./circle-x-DN-46PJV.js";import{C as L}from"./circle-check-big-CffQpfHP.js";function G(){const{toast:r}=A(),{isBusinessMember:w,isAdmin:N}=F(),{invitations:c,receivedInvitations:l,loading:o,createInvitation:f,acceptInvitation:B,rejectInvitation:I,getInvitationStatus:y}=_(),[a,d]=h.useState(""),[x,m]=h.useState(!1),C=async()=>{const s=a.trim().toLowerCase();if(s){m(!0);try{const t=await f({invitee_email:s});if(t){const p=`${window.location.origin}/accept-invite?token=${t.token}`;await navigator.clipboard.writeText(p).catch(()=>{}),r({title:"Invite link copied",description:p}),d("")}}catch{}finally{m(!1)}}},S=async s=>{try{await B(s)&&r({title:"Welcome to the Business!",description:"You are now a Business Member with access to business features."})}catch(t){console.error("Failed to accept invitation:",t)}},E=async s=>{await I(s)},k=s=>{switch(s){case"pending":return e.jsxs(n,{variant:"secondary",className:"bg-yellow-100 text-yellow-700",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),"Pending"]});case"used":return e.jsxs(n,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(L,{className:"w-3 h-3 mr-1"}),"Used"]});case"expired":return e.jsxs(n,{variant:"destructive",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),"Expired"]})}};return e.jsxs("div",{className:"space-y-6",children:[l.length>0&&e.jsxs(u,{className:"border-0",style:{background:"#EAE6E2",boxShadow:"8px 8px 20px rgba(166, 150, 130, 0.3), -8px -8px 20px rgba(255, 255, 255, 0.85)",borderRadius:"24px"},children:[e.jsxs(j,{children:[e.jsxs(v,{className:"flex items-center space-x-2 text-[#3A3530]",children:[e.jsx(M,{className:"w-5 h-5"}),e.jsx("span",{children:"Business Invitations"})]}),e.jsx(b,{className:"text-[#6B635B]",children:"You have pending invitations to become a Business Member"})]}),e.jsx(g,{className:"space-y-4",children:l.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg",style:{background:"#F5F1ED",boxShadow:"inset 2px 2px 5px rgba(166, 150, 130, 0.1), inset -2px -2px 5px rgba(255, 255, 255, 0.5)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-[#3A3530]",children:"Business Membership Invitation"}),e.jsxs("p",{className:"text-sm text-[#6B635B]",children:["Invite sent to: ",s.invitee_email]}),e.jsxs("p",{className:"text-xs text-[#6B635B]",children:["Expires: ",new Date(s.expires_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(i,{size:"sm",onClick:()=>S(s.token),disabled:o,children:"Accept"}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>E(s.id),disabled:o,children:"Reject"})]})]},s.id))})]}),(w()||N())&&e.jsxs(u,{className:"border-0",style:{background:"#EAE6E2",boxShadow:"8px 8px 20px rgba(166, 150, 130, 0.3), -8px -8px 20px rgba(255, 255, 255, 0.85)",borderRadius:"24px"},children:[e.jsxs(j,{children:[e.jsxs(v,{className:"flex items-center space-x-2 text-[#3A3530]",children:[e.jsx(z,{className:"w-5 h-5"}),e.jsx("span",{children:"Invite New Business Members"})]}),e.jsx(b,{className:"text-[#6B635B]",children:"Send invitations to new users to join the business community"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(R,{placeholder:"Enter email address",value:a,onChange:s=>d(s.target.value),type:"email"}),e.jsx(i,{onClick:C,disabled:!a.trim()||x,children:x?"Sending...":"Send Invite"})]}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-[#3A3530]",children:"Sent Invitations"}),c.slice(0,5).map(s=>{const t=y(s);return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg",style:{background:"#F5F1ED",boxShadow:"inset 2px 2px 5px rgba(166, 150, 130, 0.1), inset -2px -2px 5px rgba(255, 255, 255, 0.5)"},children:[e.jsx("span",{className:"text-sm text-[#3A3530]",children:s.invitee_email}),k(t)]},s.id)})]})]})]})]})]})}export{G as B};
