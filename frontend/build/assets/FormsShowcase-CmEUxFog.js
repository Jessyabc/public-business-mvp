import{H as L,r as h,j as e,B as j,a3 as V,m as B,at as F,A as m,z as Y,u as W,w as H,a8 as c,a9 as T,s as q,b3 as K,U as z,g as $,F as P,h as X,i as G,aZ as Z,k as J,E as Q,n as ee,bI as se}from"./index-0gfsL0uy.js";import{C as u,c as x,a as S,b as C}from"./card-DFvCEgtH.js";import{P as ae}from"./ProfileForm-3QASO2My.js";import{B as te}from"./BusinessProfileForm-Bac6OVcj.js";import{a as re}from"./useOrgRequests-DCbjQvsz.js";import{B as E}from"./building-DZ038TzP.js";import{C as ie}from"./circle-alert-BI3w8pVs.js";import{C as M}from"./circle-check-big-BI8Xdov1.js";import{u as ne}from"./useBusinessInvitations-Bguj3FE4.js";import{C as ce}from"./circle-x-hZWeZhfD.js";import{U as D}from"./user-plus-DzuQiUUv.js";import"./BusinessMemberBadge-u69G26EW.js";import"./crown-BNrmCJfh.js";import"./collapsible-AzCtvYCW.js";import"./index-FtWVSSdM.js";import"./loader-circle-CTU2R_i1.js";import"./globe-7Ydzx7cL.js";import"./save-Cyzo7cSc.js";import"./select-VgW6waeO.js";import"./index-C5PDtfbs.js";import"./chevron-down-C2_7QqD8.js";import"./useBusinessProfile-B2jwDVgR.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=L("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=L("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=L("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function oe(){const{myRequest:s,loading:v,submitRequest:p,updateRequest:f}=re(),[N,l]=h.useState(!1),[o,r]=h.useState(!1),[n,t]=h.useState({org_name:"",org_description:"",reason:""}),g=()=>{if(!s)return e.jsx(U,{className:"w-4 h-4"});switch(s.status){case"approved":return e.jsx(M,{className:"w-4 h-4 text-green-500"});case"pending":return e.jsx(Y,{className:"w-4 h-4 text-yellow-500"});case"rejected":return e.jsx(ie,{className:"w-4 h-4 text-red-500"});default:return e.jsx(U,{className:"w-4 h-4"})}},d=()=>{if(!s)return null;const i={approved:"default",pending:"secondary",rejected:"destructive"};return e.jsx(m,{variant:i[s.status]||"outline",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})},k=()=>{s&&t({org_name:s.org_name||"",org_description:s.org_description||"",reason:s.reason||""}),l(!0)},R=async i=>{if(i.preventDefault(),!!n.org_name.trim()){r(!0);try{s?await f(n):await p(n),l(!1)}catch{}finally{r(!1)}}};return v?e.jsx(u,{className:"border-[var(--glass-border)] bg-[var(--glass-bg)] backdrop-blur-[var(--glass-blur)]",children:e.jsx(x,{className:"p-6",children:e.jsx("div",{className:"text-center text-[var(--text-primary)]",children:"Loading..."})})}):N?e.jsxs(u,{className:"border-[var(--glass-border)] bg-[var(--glass-bg)] backdrop-blur-[var(--glass-blur)]",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(C,{className:"flex items-center gap-2 text-[var(--text-primary)]",children:[e.jsx(E,{className:"w-5 h-5 text-[var(--text-secondary)]"}),s?"Update Organization Request":"Request Business Account"]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>l(!1),className:"text-[var(--text-secondary)]",children:e.jsx(V,{className:"w-4 h-4"})})]})}),e.jsx(x,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"org_name",className:"text-[var(--text-primary)]",children:"Organization Name *"}),e.jsx(F,{id:"org_name",value:n.org_name,onChange:i=>t(b=>({...b,org_name:i.target.value})),placeholder:"Your company or organization name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"org_description",className:"text-[var(--text-primary)]",children:"Description"}),e.jsx(F,{id:"org_description",as:"textarea",value:n.org_description,onChange:i=>t(b=>({...b,org_description:i.target.value})),placeholder:"Brief description of your organization...",className:"min-h-[80px]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"reason",className:"text-[var(--text-primary)]",children:"Why do you want a business account?"}),e.jsx(F,{id:"reason",as:"textarea",value:n.reason,onChange:i=>t(b=>({...b,reason:i.target.value})),placeholder:"Tell us how you plan to use the business features...",className:"min-h-[80px]"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>l(!1),className:"flex-1 border-[var(--glass-border)] text-[var(--text-primary)]",children:"Cancel"}),e.jsx(j,{type:"submit",disabled:o||!n.org_name.trim(),className:"flex-1 bg-[var(--accent)] text-[var(--accent-on)] hover:bg-[var(--accent)]/80",children:o?"Submitting...":s?"Resubmit":"Submit Request"})]})]})})]}):e.jsxs(u,{className:"border-[var(--glass-border)] bg-[var(--glass-bg)] backdrop-blur-[var(--glass-blur)]",children:[e.jsx(S,{children:e.jsxs(C,{className:"flex items-center justify-between text-[var(--text-primary)]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-[var(--text-secondary)]"}),"Business Account"]}),d()]})}),e.jsx(x,{className:"space-y-4",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-[var(--text-secondary)] space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Organization:"})," ",s.org_name]}),s.org_description&&e.jsx("p",{className:"text-xs opacity-75",children:s.org_description}),s.status==="approved"&&e.jsx("p",{className:"text-green-600 mt-3",children:"✓ Your organization has been created! You can now access business features."}),s.status==="pending"&&e.jsx("p",{className:"text-yellow-600 mt-3",children:"⏱ Your request is pending admin approval."}),s.status==="rejected"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-red-600",children:"✗ Your request was rejected."}),s.reason&&e.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["Reason: ",s.reason]})]})]}),(s.status==="rejected"||s.status==="pending")&&e.jsx(j,{onClick:k,variant:"outline",className:"w-full border-[var(--glass-border)] text-[var(--text-primary)] hover:bg-[var(--card-bg-hover)]",children:s.status==="rejected"?"Update & Resubmit":"Edit Request"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Request a business account to create your organization, post business insights, and collaborate with your team."}),e.jsxs(j,{onClick:k,className:"w-full bg-[var(--accent)] text-[var(--accent-on)] hover:bg-[var(--accent)]/80",children:[g(),e.jsx("span",{className:"ml-2",children:"Request Business Account"})]})]})})]})}function de(){const{user:s,session:v}=W(),{userRoles:p,canCreateBusinessPosts:f,loading:N}=H(),{receivedInvitations:l,loading:o}=ne(),[r,n]=h.useState([]),[t,g]=h.useState(!0),d=h.useCallback(async()=>{const a=[];a.push({name:"User Authentication",status:s?"pass":"fail",message:s?`Authenticated as ${s.email}`:"No authenticated user",icon:e.jsx(le,{className:"w-4 h-4"})}),a.push({name:"Session Persistence",status:v?"pass":"fail",message:v?"Active session with valid tokens":"No active session",icon:e.jsx(c,{className:"w-4 h-4"})}),s&&!N&&(a.push({name:"User Role Assignment",status:p.length>0?"pass":"warning",message:p.length>0?`Roles: ${p.join(", ")}`:"No roles assigned",icon:e.jsx(T,{className:"w-4 h-4"})}),a.push({name:"Business Post Permissions",status:"pass",message:f?"Can create business posts":"Cannot create business posts (expected for public users)",icon:e.jsx(_,{className:"w-4 h-4"})}));try{const{data:y,error:w}=await q.from("profiles").select("id").limit(1);a.push({name:"Database Connectivity",status:w?"fail":"pass",message:w?`DB Error: ${w.message}`:"Database accessible",icon:e.jsx(_,{className:"w-4 h-4"})})}catch(y){a.push({name:"Database Connectivity",status:"fail",message:`Connection failed: ${y}`,icon:e.jsx(_,{className:"w-4 h-4"})})}if(s)try{const{data:y,error:w}=await q.rpc("get_my_roles");a.push({name:"RLS Policies - User Roles",status:w?"fail":"pass",message:w?`RLS Error: ${w.message}`:"RLS policies working correctly",icon:e.jsx(c,{className:"w-4 h-4"})});const{data:ue,error:A}=await q.from("my_posts_view").select("id").limit(1);a.push({name:"RLS Policies - Posts",status:A?"fail":"pass",message:A?`Posts RLS Error: ${A.message}`:"Posts accessible with proper RLS",icon:e.jsx(c,{className:"w-4 h-4"})})}catch(y){a.push({name:"RLS Policy Test",status:"fail",message:`RLS test failed: ${y}`,icon:e.jsx(c,{className:"w-4 h-4"})})}o||a.push({name:"Business Invitation System",status:"pass",message:`Received invitations: ${l.length}`,icon:e.jsx(T,{className:"w-4 h-4"})}),n(a),g(!1)},[s,v,p,N,f,l,o]);h.useEffect(()=>{N||o||d()},[d,N,o]);const k=a=>{switch(a){case"pass":return e.jsx(M,{className:"w-5 h-5 text-green-500"});case"fail":return e.jsx(ce,{className:"w-5 h-5 text-red-500"});case"warning":return e.jsx(K,{className:"w-5 h-5 text-yellow-500"})}},R=a=>{switch(a){case"pass":return e.jsx(m,{variant:"outline",className:"text-green-600 border-green-600",children:"PASS"});case"fail":return e.jsx(m,{variant:"destructive",children:"FAIL"});case"warning":return e.jsx(m,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"WARN"})}},i=r.filter(a=>a.status==="fail").length,b=r.filter(a=>a.status==="warning").length,O=r.filter(a=>a.status==="pass").length;return t?e.jsxs(u,{className:"glass-card",children:[e.jsx(S,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-5 h-5"}),"Security Verification"]})}),e.jsx(x,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Running security checks..."})]})})]}):e.jsxs(u,{className:"glass-card",children:[e.jsxs(S,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-5 h-5"}),"Security Verification Report"]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"text-green-600",children:[O," Passed"]}),e.jsxs("span",{className:"text-yellow-600",children:[b," Warnings"]}),e.jsxs("span",{className:"text-red-600",children:[i," Failed"]})]})]}),e.jsxs(x,{className:"space-y-4",children:[r.map((a,y)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card/50",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[a.icon,e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium",children:a.name}),R(a.status)]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})]}),k(a.status)]},y)),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(j,{onClick:d,variant:"outline",className:"w-full",children:[e.jsx(c,{className:"w-4 h-4 mr-2"}),"Re-run Security Checks"]})}),i>0&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-red-800 dark:text-red-200 mb-2",children:"Security Issues Detected"}),e.jsxs("p",{className:"text-sm text-red-600 dark:text-red-300",children:[i," critical security check(s) failed. Please review the failed items above."]})]})]})]})}const I=[{id:"profile-form",name:"Profile Form",description:"User profile editing form with avatar, bio, and social links.",component:ae,category:"profile",icon:z,requiresAuth:!0},{id:"business-profile-form",name:"Business Profile Form",description:"Business profile setup and management form for business members.",component:te,category:"business",icon:$,requiresAuth:!0,requiresBusiness:!0},{id:"business-account-request",name:"Business Account Request",description:"Form to request business account access and status management.",component:oe,category:"business",icon:D,requiresAuth:!0},{id:"security-verification",name:"Security Verification",description:"Security verification and validation form for sensitive operations.",component:de,category:"security",icon:c,requiresAuth:!0}],me=[{id:"all",name:"All Forms",icon:P},{id:"profile",name:"Profile",icon:z},{id:"business",name:"Business",icon:$},{id:"auth",name:"Authentication",icon:D},{id:"security",name:"Security",icon:c},{id:"admin",name:"Admin",icon:Z}];function De(){const[s,v]=h.useState("all"),[p,f]=h.useState(null),[N,l]=h.useState(!1),o=I.filter(t=>s==="all"||t.category===s),r=I.find(t=>t.id===p),n=(t,g)=>{try{return e.jsx(t,{},g)}catch{return e.jsx(u,{className:"border-destructive/50",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"text-center text-destructive",children:[e.jsx(c,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Form Error"}),e.jsx("p",{className:"text-sm",children:"This form encountered an error. Check console for details."}),e.jsx(j,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>f(null),children:"Back to Forms List"})]})})})}};return e.jsxs("div",{className:"container mx-auto p-6 max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Forms Showcase"}),e.jsx("p",{className:"text-muted-foreground",children:"Testing environment for all available forms and components. This page is for development and testing purposes."}),e.jsx(m,{variant:"outline",className:"mt-2",children:"Development Testing Page"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(u,{className:"h-fit",children:[e.jsx(S,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Available Forms (",o.length,")"]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsx(X,{value:s,onValueChange:v,children:e.jsx(G,{className:"grid w-full grid-cols-2 lg:grid-cols-1 gap-1",children:me.map(t=>{const g=t.icon;return e.jsxs(J,{value:t.id,className:"flex items-center gap-2 justify-start text-xs",children:[e.jsx(g,{className:"w-4 h-4"}),t.name]},t.id)})})}),e.jsx("div",{className:"space-y-2",children:o.map(t=>{const g=t.icon,d=p===t.id;return e.jsx(j,{variant:d?"default":"ghost",className:"w-full justify-start h-auto p-3",onClick:()=>f(d?null:t.id),children:e.jsxs("div",{className:"flex items-start gap-3 w-full",children:[e.jsx(g,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-left flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm",children:t.name}),e.jsx("div",{className:"text-xs text-muted-foreground line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[t.requiresAuth&&e.jsx(m,{variant:"secondary",className:"text-xs",children:"Auth"}),t.requiresBusiness&&e.jsx(m,{variant:"outline",className:"text-xs",children:"Business"})]})]}),d?e.jsx(Q,{className:"w-4 h-4 text-muted-foreground"}):e.jsx(ee,{className:"w-4 h-4 text-muted-foreground"})]})},t.id)})}),e.jsxs("div",{className:"border-t pt-4 space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Special Forms"}),e.jsxs(j,{variant:"outline",className:"w-full justify-start",onClick:()=>l(!0),children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Auth Modal (Test)"]})]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:r?e.jsxs(u,{children:[e.jsxs(S,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(r.icon,{className:"w-5 h-5"}),r.name]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"secondary",children:r.category}),r.requiresAuth&&e.jsx(m,{variant:"outline",children:"Requires Auth"}),r.requiresBusiness&&e.jsx(m,{variant:"outline",children:"Business Only"})]})]}),e.jsx(x,{children:e.jsx("div",{className:"border rounded-lg p-4 bg-muted/20",children:n(r.component,r.id)})})]}):e.jsx(u,{children:e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(P,{className:"w-16 h-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-muted-foreground mb-2",children:"No Form Selected"}),e.jsx("p",{className:"text-muted-foreground",children:"Choose a form from the list on the left to preview and test it."})]})})})]}),e.jsx(se,{open:N,onOpenChange:l}),e.jsx(u,{className:"mt-8 border-amber-200 bg-amber-50/50",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(c,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-amber-800 mb-1",children:"Development Note"}),e.jsx("p",{className:"text-amber-700 text-sm",children:"This page is for testing and development purposes. Forms may not function completely without proper authentication context or database connections. Use this to verify styling and basic functionality."})]})]})})})]})}export{De as default};
