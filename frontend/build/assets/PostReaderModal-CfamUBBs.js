import{H as L,r as m,j as e,c as N,S as U,a_ as Y,s as w,a0 as xe,a$ as he,g as me,A,u as F,Z as K,q as S,d as ue,x as pe,b0 as ge,aE as fe,aF as be,aG as O,aH as Q,b1 as X,aW as Z,aX as J,aY as ee,U as se,D as te,B as k,n as ae,b2 as q}from"./index-0gfsL0uy.js";import{L as we}from"./lightbulb-CYO_OQNk.js";import{A as je}from"./arrow-left-Mlk8Nz3C.js";import{A as ve}from"./arrow-right-BC_qDo43.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=L("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=L("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=L("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=L("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);function oe({postId:c,currentPost:u,onSelectPost:d}){const[x,r]=m.useState([]),[j,a]=m.useState(!0);m.useEffect(()=>{(async()=>{a(!0);try{const{data:n}=await w.from("post_relations").select("*").eq("child_post_id",c).in("relation_type",["origin","reply"]).order("created_at",{ascending:!0});if(!n||n.length===0){r([]),a(!1);return}const o=n.map(h=>h.parent_post_id),{data:i}=await w.from("posts").select("*").in("id",o).eq("status","active");if(!i||i.length===0){r([]),a(!1);return}const v=Array.from(new Set(i.map(h=>h.user_id))),{data:g}=await w.from("profile_cards").select("id, display_name").in("id",v),p=new Map;g&&g.forEach(h=>{p.set(h.id,h.display_name||"Unknown")});const f=i.map(h=>({post:h,authorName:p.get(h.user_id)||"Unknown"}));r(f.reverse())}catch(n){console.error("Failed to fetch lineage:",n),r([])}finally{a(!1)}})()},[c]);const l=t=>{d&&d(t.post)};return j||x.length===0?null:e.jsxs("div",{className:N("rounded-2xl p-4 mb-6","bg-white/5 backdrop-blur-xl border border-white/10","shadow-[0_8px_32px_rgba(0,0,0,0.3)]"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(U,{className:"w-4 h-4 text-primary"}),e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Thread Lineage"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[x.map((t,n)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{onClick:()=>l(t),className:N("px-3 py-1.5 rounded-lg cursor-pointer","bg-white/5 border border-white/15","transition-all duration-200 hover:bg-white/10 hover:border-primary/40"),children:[e.jsx("div",{className:"text-xs text-white/90 font-medium",children:t.authorName}),e.jsxs("div",{className:"text-[10px] text-white/60 truncate max-w-[120px]",children:[t.post.title||t.post.content.slice(0,30),"..."]})]}),n<x.length-1&&e.jsx(Y,{className:"w-3 h-3 text-white/40 flex-shrink-0"})]},t.post.id)),e.jsx(Y,{className:"w-3 h-3 text-white/40 flex-shrink-0"}),e.jsxs("div",{className:N("px-3 py-1.5 rounded-lg","bg-primary/20 border border-primary/40","shadow-[0_0_20px_rgba(72,159,227,0.3)]"),children:[e.jsx("div",{className:"text-xs text-white font-medium",children:"Current Post"}),e.jsxs("div",{className:"text-[10px] text-white/80 truncate max-w-[120px]",children:[u.title||u.content.slice(0,30),"..."]})]})]}),e.jsxs("div",{className:"mt-3 text-xs text-white/50",children:["This post continues a thread with ",x.length," ",x.length===1?"parent":"parents"]})]})}function ce({postId:c,currentPost:u,onSelectPost:d}){const[x,r]=m.useState([]),[j,a]=m.useState(!0);m.useEffect(()=>{(async()=>{a(!0);try{const{data:n}=await w.from("post_relations").select("*").eq("parent_post_id",c).in("relation_type",["reply","origin"]).order("created_at",{ascending:!1});if(!n||n.length===0){r([]),a(!1);return}const o=n.map(h=>h.child_post_id),{data:i}=await w.from("posts").select("*").in("id",o).eq("status","active").order("created_at",{ascending:!1});if(!i||i.length===0){r([]),a(!1);return}const v=Array.from(new Set(i.map(h=>h.user_id))),{data:g}=await w.from("profile_cards").select("id, display_name").in("id",v),p=new Map;g&&g.forEach(h=>{p.set(h.id,h.display_name||"Unknown")});const f=i.map(h=>({post:h,authorName:p.get(h.user_id)||"Unknown"}));r(f)}catch(n){console.error("Failed to fetch continuations:",n),r([])}finally{a(!1)}})()},[c]);const l=t=>{d&&d(t.post)};return j||x.length===0?null:e.jsxs("div",{className:N("rounded-2xl p-4 mb-6","bg-white/5 backdrop-blur-xl border border-white/10","shadow-[0_8px_32px_rgba(0,0,0,0.3)]"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ye,{className:"w-4 h-4 text-primary"}),e.jsxs("h3",{className:"text-sm font-semibold text-white",children:["Continuations (",x.length,")"]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:x.map(t=>e.jsxs("div",{onClick:()=>l(t),className:N("px-3 py-2 rounded-lg cursor-pointer","bg-white/5 border border-white/15","transition-all duration-200 hover:bg-white/10 hover:border-primary/40"),children:[e.jsx("div",{className:"text-xs text-white/90 font-medium mb-1",children:t.authorName}),e.jsxs("div",{className:"text-[11px] text-white/70 truncate",children:[t.post.title||t.post.content.slice(0,50),"..."]})]},t.post.id))})]})}function Ne(c){return xe({queryKey:["cross-links",c],queryFn:async()=>{if(!c)return[];const{data:u,error:d}=await w.from("post_relations").select("*").or(`parent_post_id.eq.${c},child_post_id.eq.${c}`).in("relation_type",["cross_link","soft","origin","quote"]).order("created_at",{ascending:!1});if(d)return console.error("Failed to fetch cross-links:",d),[];if(!u||u.length===0)return[];const x=new Set;u.forEach(t=>{t.parent_post_id!==c&&x.add(t.parent_post_id),t.child_post_id!==c&&x.add(t.child_post_id)});const{data:r,error:j}=await w.from("posts").select("*").in("id",Array.from(x)).eq("status","active");if(j||!r)return console.error("Failed to fetch cross-linked posts:",j),[];const a=new Map;r.forEach(t=>{a.set(t.id,t)});const l=[];return u.forEach(t=>{const n=t.child_post_id===c,o=n?t.parent_post_id:t.child_post_id,i=a.get(o);i&&l.push({id:t.id,post:i,relationType:t.relation_type,direction:n?"incoming":"outgoing"})}),l},enabled:!!c,staleTime:1e3*60})}function le({postId:c,onSelectPost:u}){const{data:d,isLoading:x}=Ne(c),[r,j]=m.useState(new Map);if(m.useEffect(()=>{if(!d||d.length===0)return;(async()=>{const i=Array.from(new Set(d.map(g=>g.post.user_id))),{data:v}=await w.from("profile_cards").select("id, display_name").in("id",i);if(v){const g=new Map;v.forEach(p=>{g.set(p.id,p.display_name||"Unknown")}),j(g)}})()},[d]),x||!d||d.length===0)return null;const a=d.filter(o=>o.direction==="incoming"),l=d.filter(o=>o.direction==="outgoing"),t=o=>{if(u){const i={...o.post,mode:o.post.mode||"public",status:o.post.status||"active",updated_at:o.post.created_at,likes_count:o.post.likes_count||0,comments_count:o.post.comments_count||0,views_count:o.post.views_count||0};u(i)}},n=o=>{const{post:i,direction:v,relationType:g}=o,p=i.kind==="Spark",f=i.kind==="BusinessInsight";return e.jsxs("div",{onClick:()=>t(o),className:N("rounded-xl p-4","bg-white/5 backdrop-blur-xl border border-white/10","transition-all duration-200 hover:bg-white/8 hover:border-white/20","group cursor-pointer"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsxs("div",{className:N("flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center",p&&"bg-primary/20",f&&"bg-purple-500/20"),children:[p&&e.jsx(we,{className:"w-4 h-4 text-primary"}),f&&e.jsx(me,{className:"w-4 h-4 text-purple-400"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-white truncate group-hover:text-primary transition-colors",children:i.title||i.content.slice(0,50)}),e.jsxs("div",{className:"text-xs text-white/60",children:["by ",r.get(i.user_id)||"Unknown"]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:v==="incoming"?e.jsx(je,{className:"w-4 h-4 text-white/40"}):e.jsx(ve,{className:"w-4 h-4 text-white/40"})})]}),e.jsx("p",{className:"text-xs text-white/70 line-clamp-2 mb-3",children:i.content}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(A,{variant:"outline",className:N("text-[10px] border-white/20",p&&"bg-primary/10 text-primary",f&&"bg-purple-500/10 text-purple-400"),children:i.kind}),e.jsx(A,{variant:"outline",className:"text-[10px] bg-white/5 border-white/20 text-white/60",children:g==="cross_link"||g==="soft"?"Reference":g}),v==="incoming"&&e.jsx(A,{variant:"outline",className:"text-[10px] bg-white/5 border-white/20 text-white/60",children:"Referenced by"})]})]},o.id)};return e.jsxs("div",{className:"mt-8 pt-6 border-t border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(he,{className:"w-5 h-5 text-white/80"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Cross-Links & References"}),e.jsxs("div",{className:"text-sm text-white/60",children:["(",d.length,")"]})]}),a.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-medium text-white/80 mb-3",children:["Referenced By (",a.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.map(n)})]}),l.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-white/80 mb-3",children:["References (",l.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:l.map(n)})]})]})}const P="/assets/u-score-icon-BGLRav2V.png",D=m.memo(({postId:c,currentScore:u,ratingCount:d=0,userRating:x,onRate:r,compact:j=!1,className:a,disabled:l=!1})=>{const{user:t}=F(),[n,o]=m.useState(null),[i,v]=m.useState(x??null),[g,p]=m.useState(!1),f=async y=>{if(l)return;if(!t){S.error("Please sign in to rate posts");return}if(g)return;const _=i===y?0:y;p(!0),v(_===0?null:_);try{r&&await r(_),_===0?S.success("Rating removed"):S.success(`Rated ${_}/5`),window.dispatchEvent(new CustomEvent("pb:rating:changed",{detail:{postId:c}}))}catch(s){console.error("Failed to submit rating:",s),S.error("Failed to submit rating"),v(x??null)}finally{p(!1)}},h=n??i??u;return j?e.jsxs("div",{className:N("flex items-center gap-1.5",a),children:[e.jsx("img",{src:P,alt:"U-Score",className:"w-4 h-4 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-blue-500",children:u?.toFixed(1)??"—"}),d>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",d,")"]})]}):e.jsxs("div",{className:N("space-y-3",a),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:P,alt:"U-Score",className:"w-5 h-5 object-contain"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Rate Utility"}),d>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",d," ",d===1?"rating":"ratings",")"]})]}),h&&e.jsxs(K.span,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"text-lg font-bold text-blue-500",children:[typeof h=="number"?h.toFixed(1):h,"/5"]},h)]}),e.jsx("div",{className:"flex items-center gap-1 h-8",children:[1,2,3,4,5].map(y=>{const _=i!==null&&y<=i,R=n!==null&&y<=n||_;return e.jsx(K.button,{type:"button",disabled:g||l,onClick:()=>f(y),onMouseEnter:()=>!l&&o(y),onMouseLeave:()=>o(null),className:N("relative flex-1 h-8 rounded-md transition-colors duration-200","focus:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",R?"bg-blue-500/80 shadow-[0_0_12px_rgba(59,130,246,0.4)]":"bg-muted/30 hover:bg-muted/50"),whileTap:l?{}:{scale:.95},children:e.jsx("span",{className:N("absolute inset-0 flex items-center justify-center text-xs font-medium",R?"text-white":"text-muted-foreground"),children:y})},y)})}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Not useful"}),e.jsx("span",{children:"Very useful"})]}),x&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["You rated this ",x,"/5"]})]})});D.displayName="UScoreRating";function _e(c){const{user:u}=F(),[d,x]=m.useState({userRating:null,averageScore:null,ratingCount:0,isLoading:!0,error:null}),r=m.useCallback(async()=>{if(c){x(a=>({...a,isLoading:!0,error:null}));try{const{data:a,error:l}=await w.from("view_post_u_score").select("u_score_avg, u_score_count").eq("post_id",c).maybeSingle();if(l)throw l;let t=null;if(u){const{data:n,error:o}=await w.from("post_utility_ratings").select("rating").eq("post_id",c).eq("user_id",u.id).maybeSingle();if(o&&o.code!=="PGRST116")throw o;t=n?.rating??null}x({userRating:t,averageScore:a?.u_score_avg??null,ratingCount:a?.u_score_count??0,isLoading:!1,error:null})}catch(a){console.error("Failed to fetch rating data:",a),x(l=>({...l,isLoading:!1,error:"Failed to load rating data"}))}}},[c,u]);m.useEffect(()=>{r()},[r]),m.useEffect(()=>{const a=l=>{l.detail.postId===c&&r()};return window.addEventListener("pb:rating:changed",a),()=>window.removeEventListener("pb:rating:changed",a)},[c,r]);const j=m.useCallback(async a=>{if(!u)throw new Error("Must be logged in to rate");if(a<0||a>5)throw new Error("Rating must be between 0 and 5");const{data:l,error:t}=await w.functions.invoke("rate-post",{body:{post_id:c,rating:a}});if(t)throw console.error("Rate post error:",t),t;x(n=>({...n,userRating:a,averageScore:l?.u_score_avg??n.averageScore,ratingCount:l?.u_score_count??n.ratingCount})),await r()},[c,u,r]);return{...d,submitRating:j,refetch:r}}function Ee({isOpen:c,onClose:u,post:d}){const{openComposer:x}=ue(),{user:r}=F(),{data:j}=pe(),{userRating:a,averageScore:l,ratingCount:t,submitRating:n}=_e(d?.id??""),[o,i]=m.useState(null),[v,g]=m.useState(null),[p,f]=m.useState(!1),[h,y]=m.useState(0),_=ge(),s=v||d,R=s?.mode==="business",de=_.pathname.startsWith("/business-dashboard")||_.pathname.startsWith("/admin")||_.pathname.startsWith("/insights"),M=R||de,I=s&&r&&s.user_id!==r.id&&(!s.org_id||s.org_id!==j);m.useEffect(()=>{if(!s?.user_id){i(null);return}(async()=>{const{data:C}=await w.from("profiles").select("display_name, avatar_url").eq("id",s.user_id).single();C&&i(C)})()},[s?.user_id]),m.useEffect(()=>{c||(g(null),f(!1))},[c]),m.useEffect(()=>{if(!s?.id)return;if(y(s.t_score||0),!r){f(!1);return}(async()=>{const{data:C}=await w.from("post_interactions").select("id").eq("post_id",s.id).eq("user_id",r.id).eq("kind","like").maybeSingle();f(!!C)})()},[s?.id,r]);const z=async()=>{if(!s||!r){S.error("Please sign in to give thoughts");return}try{const{data:b,error:C}=await w.functions.invoke("interact-post",{body:{post_id:s.id,type:"like"}});if(C){console.error("Error giving thought:",C),S.error("Failed to record your thought");return}b?.action==="unliked"?(f(!1),y(T=>Math.max(0,T-1)),S.success("Thought removed")):(f(!0),y(T=>T+1),S.success("Thought given!"))}catch(b){console.error("Unexpected error:",b),S.error("Failed to record your thought")}},E=b=>{g(b),i(null)};if(!s)return null;const V=async()=>{const b=`${window.location.origin}/post/${s.id}`;await navigator.clipboard.writeText(b),S.success("Link copied to clipboard")},$=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),H=b=>{switch(b){case"brainstorm":return"bg-blue-500/10 text-blue-600 border-blue-500/20";case"insight":return"bg-purple-500/10 text-purple-600 border-purple-500/20";case"report":return"bg-green-500/10 text-green-600 border-green-500/20";case"whitepaper":return"bg-orange-500/10 text-orange-600 border-orange-500/20";case"webinar":return"bg-red-500/10 text-red-600 border-red-500/20";case"video":return"bg-pink-500/10 text-pink-600 border-pink-500/20";default:return"bg-gray-500/10 text-gray-600 border-gray-500/20"}},G=b=>{switch(b){case"public":return"bg-green-500/10 text-green-600 border-green-500/20";case"my_business":return"bg-blue-500/10 text-blue-600 border-blue-500/20";case"other_businesses":return"bg-purple-500/10 text-purple-600 border-purple-500/20";case"draft":return"bg-gray-500/10 text-gray-600 border-gray-500/20";default:return"bg-gray-500/10 text-gray-600 border-gray-500/20"}},B=o?.display_name||"Unknown Author",W=o?.avatar_url||"";return e.jsx(fe,{open:c,onOpenChange:u,children:e.jsx(be,{className:`w-[calc(100%-2rem)] sm:max-w-2xl md:max-w-4xl max-w-4xl max-h-[90vh] overflow-y-auto p-0 z-50 scrollbar-none [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] ${M?"bg-transparent backdrop-blur-none border-0 shadow-none":"border-[var(--glass-border)] bg-transparent backdrop-blur-none"}`,children:M?e.jsxs("div",{className:"p-6 rounded-2xl",style:{background:"#EAE6E2",boxShadow:"8px 8px 20px rgba(166, 150, 130, 0.3), -8px -8px 20px rgba(255, 255, 255, 0.85)"},children:[e.jsxs(O,{children:[e.jsx(Q,{className:"sr-only",children:"Post Details"}),e.jsx(X,{className:"sr-only",children:"View post details and navigate through continuations"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(oe,{postId:s.id,currentPost:s,onSelectPost:E}),e.jsx(ce,{postId:s.id,currentPost:s,onSelectPost:E}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(Z,{className:"h-12 w-12",children:[e.jsx(J,{src:W}),e.jsx(ee,{className:"bg-[#4A7C9B]/20 text-[#4A7C9B]",children:B.charAt(0).toUpperCase()||e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-[#3A3530]",children:B}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-[#6B635B]",children:[e.jsx(te,{className:"h-3 w-3"}),e.jsx("span",{children:$(s.created_at)})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:H(s.type),children:s.type}),e.jsx(A,{className:G(s.visibility),children:s.visibility})]})]}),e.jsxs("div",{className:"space-y-4 p-4 rounded-xl",style:{boxShadow:"inset 6px 6px 12px rgba(166, 150, 130, 0.4), inset -6px -6px 12px rgba(255, 255, 255, 0.6)"},children:[s.title&&e.jsx("h2",{className:"text-2xl font-bold text-[#3A3530] mb-2",children:s.title}),e.jsx("div",{className:"max-w-none",children:e.jsx("p",{className:"text-[#3A3530] whitespace-pre-wrap leading-relaxed",children:s.content})})]}),s.mode==="business"&&e.jsx("div",{className:"mt-4 p-4 rounded-xl",style:{boxShadow:"inset 6px 6px 12px rgba(166, 150, 130, 0.4), inset -6px -6px 12px rgba(255, 255, 255, 0.6)"},children:e.jsx(D,{postId:s.id,currentScore:l,ratingCount:t,userRating:a,onRate:n,disabled:!I})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-[#D4CEC5]",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[s.mode==="business"&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-blue-500 font-semibold",children:[e.jsx("img",{src:P,alt:"U-Score",className:"w-4 h-4 object-contain"}),e.jsx("span",{children:l?.toFixed(1)??"—"}),t>0&&e.jsxs("span",{className:"text-[#6B635B] font-normal",children:["(",t,")"]})]}),s.mode==="public"&&e.jsxs(k,{variant:"ghost",size:"sm",onClick:z,disabled:!r,className:`${p?"text-purple-500":"text-[#6B635B]"} hover:text-purple-500`,children:[e.jsx(U,{className:`h-4 w-4 mr-2 ${p?"fill-current":""}`}),p?"Thought given":"This made me think",e.jsxs("span",{className:"ml-2 font-semibold",children:["(",h,")"]})]}),e.jsxs(k,{variant:"ghost",size:"sm",className:"text-[#6B635B] hover:text-[#3A3530]",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),s.views_count||0]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(k,{variant:"ghost",size:"sm",className:"text-[#6B635B] hover:text-[#3A3530]",onClick:()=>x({parentPostId:s.id,relationType:"continuation"}),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Reply"]}),e.jsx(k,{variant:"ghost",size:"sm",className:"text-[#6B635B] hover:text-[#3A3530]",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(k,{variant:"ghost",size:"sm",className:"text-[#6B635B] hover:text-[#3A3530]",onClick:V,children:e.jsx(ne,{className:"h-4 w-4"})})]})]}),e.jsx(le,{postId:s.id,onSelectPost:E})]})]}):e.jsxs(q,{children:[e.jsxs(O,{children:[e.jsx(Q,{className:"sr-only",children:"Post Details"}),e.jsx(X,{className:"sr-only",children:"View post details and navigate through continuations"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(oe,{postId:s.id,currentPost:s,onSelectPost:E}),e.jsx(ce,{postId:s.id,currentPost:s,onSelectPost:E}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(Z,{className:"h-12 w-12",children:[e.jsx(J,{src:W}),e.jsx(ee,{className:"bg-primary/20 text-primary",children:B.charAt(0).toUpperCase()||e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-[var(--text-primary)]",children:B}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-[var(--text-secondary)]",children:[e.jsx(te,{className:"h-3 w-3"}),e.jsx("span",{children:$(s.created_at)})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:H(s.type),children:s.type}),e.jsx(A,{className:G(s.visibility),children:s.visibility})]})]}),e.jsxs(q,{inset:!0,className:"space-y-4",children:[s.title&&e.jsx("h2",{className:"text-2xl font-bold text-[var(--text-primary)] mb-2",children:s.title}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-[var(--text-primary)] whitespace-pre-wrap leading-relaxed",children:s.content})})]}),s.mode==="business"&&e.jsx(q,{inset:!0,className:"mt-4",children:e.jsx(D,{postId:s.id,currentScore:l,ratingCount:t,userRating:a,onRate:n,disabled:!I})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-[var(--glass-border)]",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[s.mode==="business"&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-blue-500 font-semibold",children:[e.jsx("img",{src:P,alt:"U-Score",className:"w-4 h-4 object-contain"}),e.jsx("span",{children:l?.toFixed(1)??"—"}),t>0&&e.jsxs("span",{className:"text-muted-foreground font-normal",children:["(",t,")"]})]}),s.mode==="public"&&e.jsxs(k,{variant:"ghost",size:"sm",onClick:z,disabled:!r,className:`${p?"text-purple-500":"text-[var(--text-secondary)]"} hover:text-purple-500`,children:[e.jsx(U,{className:`h-4 w-4 mr-2 ${p?"fill-current":""}`}),p?"Thought given":"This made me think",e.jsxs("span",{className:"ml-2 font-semibold",children:["(",h,")"]})]}),e.jsxs(k,{variant:"ghost",size:"sm",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),s.views_count||0]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(k,{variant:"ghost",size:"sm",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",onClick:()=>x({parentPostId:s.id,relationType:"continuation"}),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Reply"]}),e.jsx(k,{variant:"ghost",size:"sm",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(k,{variant:"ghost",size:"sm",className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",onClick:V,children:e.jsx(ne,{className:"h-4 w-4"})})]})]}),e.jsx(le,{postId:s.id,onSelectPost:E})]})]})})})}export{re as B,Ee as P};
